98c98
<   integer(IN) :: sprecc,sprecl,sprecn,sco2p,sco2d,sswup,sprec 
---
>   integer(IN) :: sprecc,sprecl,sprecn,sco2p,sco2d,sswup,sprec,starcf
143c143
<   integer(IN),parameter :: ktranss = 18
---
>   integer(IN),parameter :: ktranss = 19
149c149
<        "strm_swup       ","strm_prec       " /)
---
>        "strm_swup       ","strm_prec       ","strm_tarcf      " /)
155c155
<        "swup            ","prec            " /)
---
>        "swup            ","prec            ","tarcf           " /)
317c317
<     presaero = .false.	
---
>     presaero = .false.
369,374c369,375
<     if (trim(atm_mode) == 'NULL' .or. &
<         trim(atm_mode) == 'TN460' .or. &
<         trim(atm_mode) == 'CORE2' .or. &
<         trim(atm_mode) == 'CLMNCEP' .or. &
<         trim(atm_mode) == 'CPLHIST' .or. &
<         trim(atm_mode) == 'COPYALL') then
---
>     if (trim(atm_mode) == 'NULL'      .or. &
>         trim(atm_mode) == 'TN460'     .or. &
>         trim(atm_mode) == 'CORE2_NYF' .or. &
>         trim(atm_mode) == 'CORE2_IAF' .or. &
>         trim(atm_mode) == 'CLMNCEP'   .or. &
>         trim(atm_mode) == 'CPLHIST'   .or. &
>         trim(atm_mode) == 'COPYALL'   ) then
561a563
>     starcf = mct_aVect_indexRA(avstrm,'strm_tarcf',perrWith='quiet')
934c936
<    case('CORE2')
---
>    case('CORE2_NYF','CORE2_IAF')
937,938c939,946
<             write(logunit,F00) ' ERROR: prec and swdn must be in streams for CORE2'
<             call shr_sys_abort(trim(subname)//' ERROR: prec and swdn must be in streams for CORE2')
---
>             write(logunit,F00) 'ERROR: prec and swdn must be in streams for CORE2'
>             call shr_sys_abort(trim(subname)//'ERROR: prec and swdn must be in streams for CORE2')
>          endif
>          if (trim(atm_mode) == 'CORE2_IAF' ) then
>             if (starcf < 1 ) then
>                write(logunit,F00) 'ERROR: tarcf must be in an input stream for CORE2_IAF'
>                call shr_sys_abort(trim(subname)//'tarcf must be in an input stream for CORE2_IAF')
>             endif
977a986,993
>          !--- Dupont correction to NCEP Arctic air T  ---
>          !--- don't correct during summer months (July-September)
>          !--- ONLY correct when forcing year is 1997->2004
>          if (trim(atm_mode) == 'CORE2_IAF' ) then
>             a2x%rAttr(ktbot,n) = a2x%rAttr(ktbot,n) +  avstrm%rAttr(starcf,n)
>             a2x%rAttr(kptem,n) = a2x%rAttr(ktbot,n)
>          end if
> 
